---
title: "Results"
author: "Loong Kuan"
date: "16 September 2016"
output: 
  html_document:
    fig_width: 10
    fig_height: 7.5
---

```{r setup, echo = FALSE}
options(width=80)
knitr::opts_chunk$set(echo = FALSE, out.width='750px', dpi=200)
library(knitr)
library(ggplot2)
library(ggrepel)
library(reshape2)
library(gridExtra)
library(grid)
library(foreign)
read_chunk("../read_data.R")
read_chunk("../result_table.R")
read_chunk("../distance_matrix.R")
read_chunk("../visualisation.R")
read_chunk("../compare_distributions.R")
read_chunk("../coditioned_covariates.R")
read_chunk("../covariates.R")
```




## Original Data of 2 Dates
```{r}
<<arff>>
```


Load the satellite data set on the day *2013-05-05* and *2013-11-29*.
```{r load_satellite}
file1 <- "../../datasets/train_seed/20130505.arff"
file2 <- "../../datasets/train_seed/20131129.arff"
data.all <- ReadArffData(file1, file2)
```
Data from *2013-05-05*.
```{r}
print(head(data.all[[1]], 5))
```
Data from *2013-11-29*.
```{r}
print(head(data.all[[2]], 5))
```

Histogram of the data by attributes.
```{r, echo = FALSE}
<<visualisation>>
<<compare>>
```
```{r, echo = FALSE}
  Histogram(data.all[[1]], data.all[[2]])
```

## Drift Results
The raw data of the results will be provided at the end of this document.
```{r, include=F}
<<results>>
  results.prior.1 <- ResultTable("../../data_out/martvard/20130505_20131129_1-attributes_prior.csv")
  results.prior.2 <- ResultTable("../../data_out/martvard/20130505_20131129_2-attributes_prior.csv")
  results.prior.3 <- ResultTable("../../data_out/martvard/20130505_20131129_3-attributes_prior.csv")
  results.cc.1 <- ResultTable("../../data_out/martvard/20130505_20131129_1-attributes_ConditionedCovariate.csv")
  results.cc.2 <- ResultTable("../../data_out/martvard/20130505_20131129_2-attributes_ConditionedCovariate.csv")
  results.pos.1 <- ResultTable("../../data_out/martvard/20130505_20131129_1-attributes_posterior.csv")
  results.pos.2 <- ResultTable("../../data_out/martvard/20130505_20131129_2-attributes_posterior.csv")
  results.pos.3 <- ResultTable("../../data_out/martvard/20130505_20131129_3-attributes_posterior.csv")
```

-------------------------------------------

### Covariate Drift
The following is the results for a test of 1 Attribute. 
We can verify the correctness of the results by comparing them to the histograms of the attributes above.

```{r}
  <<covar>>
  SingleHistogramVisual(results.prior.1)
```

The following is the covariate results for 2 Attributes.
This plot is just an exercise on how results from larger amounts of attributes might be visualised.

The plot is made by first constructing a "distance matrix" where the distance obtained for each pair of attribute is represneted.

```{r}
<<distance_matrix>>
  attributes.all <- ExtractAttributes(results.prior.2)
  distanceMatrix <- DistanceMatrix(results.prior.2)
  print(distanceMatrix)
```

This matrix is then plotted using Multidimensional Scaling to visualise the distances in the matrix.
The final plot will then plot attributes that have a higher dirft together further apart.

```{r}
  MDS(distanceMatrix, attributes.all)
```

We can also plot the distance matrix as a heatmap to directly view the results. 
However this method only works with 2 attribute tests.

```{r}
  DualHistogramVisual(results.prior.1, results.prior.2)
```

Here is a heatmap for 3 attributes that contains the attribute with the highest variance in difference.
```{r}
  TripleCovariateVisual(results.prior.1, results.prior.2, results.prior.3)
```

--------------------------------------------------

### Conditioned Covaraites (Single Attributes)
```{r}
<<cond_covar>>
  JointVisualisation(results.cc.1)
```

### Conditioned Covaraites (Pair Attributes)
```{r, fig.width = 15, fig.height=15}
  PairwiseAttributes(results.cc.1, results.cc.2)
```

---------------------------------------------------------------------------------------------------

### Posterior (1 Attribute)

```{r}
  DualHistogramVisual(results.pos.1, results.pos.2, "Posterior")
  TripleCovariateVisual(results.pos.1, results.pos.2, results.pos.3, "Posterior")
```


--------------------------------------------------------------------------------

## Raw Data
https://github.com/LeeLoongKuan/DriftMapper/tree/master/data_out/martvard

## Raw Plots
https://github.com/LeeLoongKuan/DriftMapper/tree/master/DataAnalysisR/Plots


