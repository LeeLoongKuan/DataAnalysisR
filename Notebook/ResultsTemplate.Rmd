---
title: "ResultTemplate"
author: "Loong Kuan"
date: "17 September 2016"
output: 
  html_document:
    fig_width: 10
    fig_height: 7.5
params:
  data_file: "sensor"
---

```{r setup, echo = FALSE}
options(width=80)
knitr::opts_chunk$set(echo = FALSE, out.width='750px', dpi=200)
library(knitr)
library(ggplot2)
library(ggrepel)
library(reshape2)
library(gridExtra)
library(grid)
library(foreign)
read_chunk("../read_data.R")
read_chunk("../result_table.R")
read_chunk("../distance_matrix.R")
read_chunk("../visualisation.R")
read_chunk("../compare_distributions.R")
read_chunk("../coditioned_covariates.R")
read_chunk("../covariates.R")
```




## Original Data of 2 Dates
```{r}
<<arff>>
```


Load data.
```{r load_satellite}
file1 <- paste("../../datasets/", params$data_file, ".arff", sep = "")
#file1 <- "../../datasets/sensor.arff"
#file2 <- "../../datasets/train_seed/20131129.arff"
data.all <- ReadArffData(file1)
```
Data from before "drift".
```{r}
print(head(data.all[[1]], 5))
```
Data from after "drfit".
```{r}
print(head(data.all[[2]], 5))
```

Histogram of the data by attributes.
```{r, echo = FALSE}
<<visualisation>>
<<compare>>
```
```{r, echo = FALSE}
  Histogram(data.all[[1]], data.all[[2]])
```

## Drift Results
The raw data of the results will be provided at the end of this document.
```{r, include=F}
<<results>>
  target_file = "20130505_20131129"
  results.prior.1 <- ResultTable(paste("../../data_out/martvard/", params$data_file, "_1-attributes_prior.csv", sep = ""))
  results.prior.2 <- ResultTable(paste("../../data_out/martvard/", params$data_file, "_2-attributes_prior.csv", sep = ""))
  results.cc.1 <- ResultTable(paste("../../data_out/martvard/", params$data_file, "_1-attributes_ConditionedCovariate.csv", sep = ""))
  results.cc.2 <- ResultTable(paste("../../data_out/martvard/", params$data_file, "_2-attributes_ConditionedCovariate.csv", sep = ""))
  results.pos.1 <- ResultTable(paste("../../data_out/martvard/", params$data_file, "_1-attributes_posterior.csv", sep = ""))
  results.pos.2 <- ResultTable(paste("../../data_out/martvard/", params$data_file, "_2-attributes_posterior.csv", sep = ""))
```

### Covariate Drift
The following is the results for a test of 1 Attribute. 
We can verify the correctness of the results by comparing them to the histograms of the attributes above.

```{r}
  <<covar>>
  SingleHistogramVisual(results.prior.1)
```

-----------------------------------------

The following is the covariate results for 2 Attributes.
This plot is just an exercise on how results from larger amounts of attributes might be visualised.

The plot is made by first constructing a "distance matrix" where the distance obtained for each pair of attribute is represneted.

```{r}
<<distance_matrix>>
  attributes.all <- ExtractAttributes(results.prior.2)
  distanceMatrix <- DistanceMatrix(results.prior.2)
  print(distanceMatrix)
```

This matrix is then plotted using Multidimensional Scaling to visualise the distances in the matrix.
The final plot will then plot attributes that have a higher dirft together further apart.

```{r}
  MDS(distanceMatrix, attributes.all)
```

We can also plot the distance matrix as a heatmap to directly view the results. 
However this method only works with 2 attribute tests.

```{r}
  DualHistogramVisual(results.prior.1, results.prior.2)
```


### Conditioned Covaraites (Single Attributes)
```{r}
<<cond_covar>>
  JointVisualisation(results.cc.1)
```

Gred Values means that the specific class does not occur in the dataset.

### Conditioned Covaraites (Pair Attributes)
```{r, fig.width = 16, fig.height=17}
  PairwiseAttributes(results.cc.1, results.cc.2)
```

### Posterior (1 Attribute)
```{r}
  RawDataToHeatMap(results.pos.1, results.pos.2, "Posterior 2 Attributes")
```


--------------------------------------------------------------------------------

## Raw Data
https://github.com/LeeLoongKuan/DriftMapper/tree/master/data_out/martvard

## Raw Plots
https://github.com/LeeLoongKuan/DriftMapper/tree/master/DataAnalysisR/Plots
